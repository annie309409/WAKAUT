{"ast":null,"code":"import _defineProperty from \"C:/Users/fullstack/Desktop/TeamWorks/WAKAUT/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"C:/Users/fullstack/Desktop/TeamWorks/WAKAUT/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\fullstack\\\\Desktop\\\\TeamWorks\\\\WAKAUT\\\\next\\\\pages\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Button, Container, Form, FormSelect } from \"react-bootstrap\";\nimport List from \"../components/list\";\nimport { useEffect, useState } from \"react\";\nimport { AiTwotoneHeart } from \"react-icons/ai\";\nimport PlaceModal from \"./place_modal\";\nimport img from '../assets/workaut.png';\nimport mapicon from '../assets/map-icon.png';\nimport getLayout from \"../components/layouts/getLayout\";\nimport Modal from \"../components/modal\";\nimport dynamic from 'next/dynamic';\nimport kakaoShare from \"../services/kakaoShare\";\nvar Map = dynamic(_c = function _c() {\n  return import(\"react-kakao-maps-sdk\").then(function (module) {\n    return module.Map;\n  });\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-kakao-maps-sdk\")];\n    },\n    modules: [\"index.js -> \" + \"react-kakao-maps-sdk\"]\n  }\n});\n_c2 = Map;\nvar MapMarker = dynamic(_c3 = function _c3() {\n  return import(\"react-kakao-maps-sdk\").then(function (module) {\n    return module.MapMarker;\n  });\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-kakao-maps-sdk\")];\n    },\n    modules: [\"index.js -> \" + \"react-kakao-maps-sdk\"]\n  }\n});\n_c4 = MapMarker;\nexport var __N_SSP = true;\nexport default function Index(_ref) {\n  _s();\n\n  var _this2 = this;\n\n  var items = _ref.items;\n\n  var _useState = useState(false),\n      lgShow = _useState[0],\n      setLgShow = _useState[1];\n\n  var _useState2 = useState(false),\n      show = _useState2[0],\n      setShow = _useState2[1];\n\n  var des = '#에어로빅 #줌바 #조깅';\n\n  var _useState3 = useState(\"\"),\n      selectedSigun = _useState3[0],\n      setSelectedSigun = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      selectedFacility = _useState4[0],\n      setSelectedFacility = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      searchText = _useState5[0],\n      setSearchText = _useState5[1];\n\n  var _useState6 = useState(items),\n      searchResults = _useState6[0],\n      setSearchResults = _useState6[1]; // 검색결과 저장 state\n\n\n  var _useState7 = useState(null),\n      selectedPlace = _useState7[0],\n      setSelectedPlace = _useState7[1]; // 마커 클릭시 모달 state\n\n\n  var _useState8 = useState(items.length),\n      searchCount = _useState8[0],\n      setSearchCount = _useState8[1]; // 총 몇개의 시설이 조회된건지 저장하는 state\n  // 시군명 선택 시 시설구분명 셀렉트 태그에 표시할 options 배열 반환\n\n\n  function getFacilityOptions(sigun) {\n    var _this = this;\n\n    var facilities = items.filter(function (item) {\n      return item.SIGUN_NM === sigun;\n    });\n\n    var facilityNames = _toConsumableArray(new Set(facilities.map(function (item) {\n      return item.FACLT_DIV_NM;\n    })));\n\n    return facilityNames.map(function (name) {\n      return __jsx(\"option\", {\n        key: name,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 44\n        }\n      }, name);\n    });\n  } // 시군명 선택 시 시설구분명 셀렉트 태그 업데이트 및 지도 중심좌표 설정\n\n\n  function handleSigunChange(e) {\n    setSelectedSigun(e.target.value);\n    setSelectedFacility(\"\");\n    setSearchText(\"\"); // 시설 데이터 중 첫번째 시설의 위도와 경도 정보 가져오기\n\n    var firstFacility = items.find(function (item) {\n      return item.SIGUN_NM === e.target.value;\n    });\n\n    if (firstFacility) {\n      var lat = parseFloat(firstFacility.REFINE_WGS84_LAT);\n      var lng = parseFloat(firstFacility.REFINE_WGS84_LOGT); // 위도와 경도 정보로 중심 좌표 설정\n\n      setState(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          center: {\n            lat: lat,\n            lng: lng\n          }\n        });\n      });\n    } // 검색 결과 초기화\n\n\n    setSearchResults([]);\n    setSearchCount(0);\n  } // 시설구분명 선택 시 state 업데이트\n\n\n  function handleFacilityChange(e) {\n    setSelectedFacility(e.target.value);\n  } // 검색어 입력 시 state 업데이트\n\n\n  function handleSearchTextChange(e) {\n    setSearchText(e.target.value); // 검색 결과 초기화\n\n    setSearchResults([]);\n    setSearchCount(0);\n  }\n\n  function handleSearchButtonClick() {\n    // items 객체 복사\n    var results = _toConsumableArray(items); // 선택된 시군명이 있다면, 해당 시군명에 해당하는 시설들만 필터링\n\n\n    if (selectedSigun) {\n      results = results.filter(function (item) {\n        return item.SIGUN_NM === selectedSigun;\n      });\n    } // 선택된 시설구분명이 있다면, 해당 시설구분명에 해당하는 시설들만 필터링\n\n\n    if (selectedFacility) {\n      results = results.filter(function (item) {\n        return item.FACLT_DIV_NM === selectedFacility;\n      });\n    } // 검색어가 있다면, 시설명이 해당 검색어를 포함하는 시설들만 필터링\n\n\n    if (searchText) {\n      results = results.filter(function (item) {\n        return item.FACLT_NM.includes(searchText);\n      });\n    }\n\n    if (results.length === 0) setShow(true);else {\n      setSearchResults(results);\n      setSearchCount(results.length);\n    }\n  }\n\n  var _useState9 = useState({\n    center: {\n      lat: 37.28892227326957,\n      lng: 127.05363481102465\n    },\n    errMsg: null,\n    isLoading: true\n  }),\n      state = _useState9[0],\n      setState = _useState9[1];\n\n  useEffect(function () {\n    if (navigator.geolocation) {\n      // GeoLocation을 이용해서 접속 위치를 얻어옵니다\n      navigator.geolocation.getCurrentPosition(function (position) {\n        setState(function (prev) {\n          return _objectSpread(_objectSpread({}, prev), {}, {\n            center: {\n              lat: position.coords.latitude,\n              // 위도\n              lng: position.coords.longitude // 경도\n\n            },\n            isLoading: false\n          });\n        });\n      }, function (err) {\n        setState(function (prev) {\n          return _objectSpread(_objectSpread({}, prev), {}, {\n            errMsg: err.message,\n            isLoading: false\n          });\n        });\n      });\n    } else {\n      // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다\n      setState(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          errMsg: \"geolocation을 사용할수 없어요..\",\n          isLoading: false\n        });\n      });\n    }\n  }, []);\n  return __jsx(Container, {\n    className: \"d-flex mt-4 mb-4 index\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"left col-6 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  }, \"\\uCD1D \", searchCount, \"\\uAC74\"), searchResults.map(function (item) {\n    return __jsx(List, {\n      key: item.FACLT_NM,\n      title: item.FACLT_NM,\n      malcnt: __jsx(AiTwotoneHeart, {\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 33\n        }\n      }),\n      note: item.REFINE_ROADNM_ADDR,\n      col: \"bg-secondary\",\n      textClick: function textClick() {\n        setSelectedPlace(item);\n        setLgShow(true);\n        var lat = parseFloat(item.REFINE_WGS84_LAT);\n        var lng = parseFloat(item.REFINE_WGS84_LOGT);\n        setState(function (prev) {\n          return _objectSpread(_objectSpread({}, prev), {}, {\n            center: {\n              lat: lat,\n              lng: lng\n            }\n          });\n        });\n      },\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 21\n      }\n    });\n  })), __jsx(\"div\", {\n    className: \"right col-6 ms-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }\n  }, __jsx(Form, {\n    className: \"d-flex mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, __jsx(FormSelect, {\n    value: selectedSigun,\n    onChange: handleSigunChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 21\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 25\n    }\n  }, \"\\uC2DC\\uAD70\"), _toConsumableArray(new Set(items.map(function (item) {\n    return item.SIGUN_NM;\n  }))).map(function (sigun) {\n    return __jsx(\"option\", {\n      key: sigun,\n      value: sigun,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 29\n      }\n    }, sigun);\n  })), selectedSigun ? __jsx(FormSelect, {\n    value: selectedFacility,\n    onChange: handleFacilityChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 29\n    }\n  }, \"\\uC2DC\\uC124\\uAD6C\\uBD84\\uBA85\"), getFacilityOptions(selectedSigun)) : __jsx(FormSelect, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 29\n    }\n  }, \"\\uC2DC\\uC124\\uAD6C\\uBD84\\uBA85\")), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"\\uC5B4\\uB514\\uC11C \\uC6B4\\uB3D9\\uD560\\uAE4C\\uC694?\",\n    value: searchText,\n    onChange: handleSearchTextChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 21\n    }\n  }), __jsx(Button, {\n    onClick: handleSearchButtonClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 21\n    }\n  }, \"Search\")), __jsx(Map, {\n    center: state.center,\n    style: {\n      width: \"100%\",\n      height: \"800px\"\n    },\n    level: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 13\n    }\n  }, (!state.isLoading ? searchResults : []).map(function (item) {\n    return __jsx(MapMarker, {\n      key: item.FACLT_NM,\n      position: {\n        lat: item.REFINE_WGS84_LAT,\n        lng: item.REFINE_WGS84_LOGT\n      },\n      onClick: function onClick() {\n        setSelectedPlace(item);\n        setLgShow(true);\n      },\n      image: {\n        src: \"\".concat(mapicon),\n        size: {\n          width: 30,\n          height: 30\n        },\n        options: {\n          offset: {\n            x: 27,\n            y: 69\n          }\n        }\n      },\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 21\n      }\n    });\n  }))), __jsx(PlaceModal, {\n    size: \"lg\",\n    lgShow: lgShow,\n    setLgShow: setLgShow,\n    score: 3,\n    title: selectedPlace ? selectedPlace.FACLT_NM : \"\",\n    addr: selectedPlace ? selectedPlace.REFINE_ROADNM_ADDR : \"\",\n    contact: selectedPlace ? selectedPlace.CONTCT_NO : \"\",\n    des: des,\n    img: img,\n    lat: selectedPlace ? selectedPlace.REFINE_WGS84_LAT : null,\n    lng: selectedPlace ? selectedPlace.REFINE_WGS84_LOGT : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }\n  }), __jsx(Modal, {\n    \"class\": \"searchModal\",\n    size: \"sm\",\n    lgShow: show,\n    setLgShow: setShow,\n    children: \"\\uD574\\uB2F9\\uD558\\uB294 \\uC2DC\\uC124\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }\n  }));\n}\n\n_s(Index, \"yNQQgU8Qdv4OCVUYeshn5PUVonI=\");\n\n_c5 = Index;\ngetLayout(Index, {\n  title: '주변에서 운동해요! WAKAUT!',\n  description: '신개념 운동 플랫폼 워크아웃!'\n});\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"Map$dynamic\");\n$RefreshReg$(_c2, \"Map\");\n$RefreshReg$(_c3, \"MapMarker$dynamic\");\n$RefreshReg$(_c4, \"MapMarker\");\n$RefreshReg$(_c5, \"Index\");","map":{"version":3,"sources":["C:/Users/fullstack/Desktop/TeamWorks/WAKAUT/next/pages/index.js"],"names":["Button","Container","Form","FormSelect","List","useEffect","useState","AiTwotoneHeart","PlaceModal","img","mapicon","getLayout","Modal","dynamic","kakaoShare","Map","then","module","ssr","MapMarker","Index","items","lgShow","setLgShow","show","setShow","des","selectedSigun","setSelectedSigun","selectedFacility","setSelectedFacility","searchText","setSearchText","searchResults","setSearchResults","selectedPlace","setSelectedPlace","length","searchCount","setSearchCount","getFacilityOptions","sigun","facilities","filter","item","SIGUN_NM","facilityNames","Set","map","FACLT_DIV_NM","name","handleSigunChange","e","target","value","firstFacility","find","lat","parseFloat","REFINE_WGS84_LAT","lng","REFINE_WGS84_LOGT","setState","prev","center","handleFacilityChange","handleSearchTextChange","handleSearchButtonClick","results","FACLT_NM","includes","errMsg","isLoading","state","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","err","message","REFINE_ROADNM_ADDR","width","height","src","size","options","offset","x","y","CONTCT_NO","title","description"],"mappings":";;;;;;;;;;;;;AAAA,SAAQA,MAAR,EAAgBC,SAAhB,EAA2BC,IAA3B,EAAiCC,UAAjC,QAAkD,iBAAlD;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,cAAT,QAA+B,gBAA/B;AACA,OAAOC,UAAP,MAAuB,eAAvB;AACA,OAAOC,GAAP,MAAgB,uBAAhB;AACA,OAAOC,OAAP,MAAoB,wBAApB;AACA,OAAOC,SAAP,MAAsB,iCAAtB;AAEA,OAAOC,KAAP,MAAkB,qBAAlB;AAGA,OAAOC,OAAP,MAAoB,cAApB;AAEA,OAAOC,UAAP,MAAuB,wBAAvB;AACA,IAAMC,GAAG,GAAGF,OAAO,MAAC;AAAA,SAAM,OAAO,sBAAP,EAA+BG,IAA/B,CAAoC,UAACC,MAAD;AAAA,WAAYA,MAAM,CAACF,GAAnB;AAAA,GAApC,CAAN;AAAA,CAAD,EAAoE;AACnFG,EAAAA,GAAG,EAAE,KAD8E;AAAA;AAAA;AAAA,kCAAtD,sBAAsD;AAAA;AAAA,+BAAtD,sBAAsD;AAAA;AAAA,CAApE,CAAnB;MAAMH,G;AAGN,IAAMI,SAAS,GAAGN,OAAO,OAAC;AAAA,SAAM,OAAO,sBAAP,EAA+BG,IAA/B,CAAoC,UAACC,MAAD;AAAA,WAAYA,MAAM,CAACE,SAAnB;AAAA,GAApC,CAAN;AAAA,CAAD,EAA0E;AAC/FD,EAAAA,GAAG,EAAE,KAD0F;AAAA;AAAA;AAAA,kCAA5D,sBAA4D;AAAA;AAAA,+BAA5D,sBAA4D;AAAA;AAAA,CAA1E,CAAzB;MAAMC,S;;AASN,eAAe,SAASC,KAAT,OAAwB;AAAA;;AAAA;;AAAA,MAARC,KAAQ,QAARA,KAAQ;;AAAA,kBACPf,QAAQ,CAAC,KAAD,CADD;AAAA,MAC5BgB,MAD4B;AAAA,MACpBC,SADoB;;AAAA,mBAEXjB,QAAQ,CAAC,KAAD,CAFG;AAAA,MAE5BkB,IAF4B;AAAA,MAEtBC,OAFsB;;AAInC,MAAIC,GAAG,GAAG,eAAV;;AAJmC,mBAMOpB,QAAQ,CAAC,EAAD,CANf;AAAA,MAM5BqB,aAN4B;AAAA,MAMbC,gBANa;;AAAA,mBAOatB,QAAQ,CAAC,EAAD,CAPrB;AAAA,MAO5BuB,gBAP4B;AAAA,MAOVC,mBAPU;;AAAA,mBAQCxB,QAAQ,CAAC,EAAD,CART;AAAA,MAQ5ByB,UAR4B;AAAA,MAQhBC,aARgB;;AAAA,mBASO1B,QAAQ,CAACe,KAAD,CATf;AAAA,MAS5BY,aAT4B;AAAA,MASbC,gBATa,kBASyB;;;AATzB,mBAUO5B,QAAQ,CAAC,IAAD,CAVf;AAAA,MAU5B6B,aAV4B;AAAA,MAUbC,gBAVa,kBAUyB;;;AAVzB,mBAWG9B,QAAQ,CAACe,KAAK,CAACgB,MAAP,CAXX;AAAA,MAW5BC,WAX4B;AAAA,MAWfC,cAXe,kBAW4B;AAG/D;;;AACA,WAASC,kBAAT,CAA4BC,KAA5B,EAAmC;AAAA;;AAC/B,QAAMC,UAAU,GAAGrB,KAAK,CAACsB,MAAN,CAAa,UAACC,IAAD;AAAA,aAAUA,IAAI,CAACC,QAAL,KAAkBJ,KAA5B;AAAA,KAAb,CAAnB;;AACA,QAAMK,aAAa,sBAAO,IAAIC,GAAJ,CAAQL,UAAU,CAACM,GAAX,CAAe,UAACJ,IAAD;AAAA,aAAUA,IAAI,CAACK,YAAf;AAAA,KAAf,CAAR,CAAP,CAAnB;;AACA,WAAOH,aAAa,CAACE,GAAd,CAAkB,UAACE,IAAD;AAAA,aAAU;AAAQ,QAAA,GAAG,EAAEA,IAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAoBA,IAApB,CAAV;AAAA,KAAlB,CAAP;AACH,GAnBkC,CAqBnC;;;AACA,WAASC,iBAAT,CAA2BC,CAA3B,EAA8B;AAC1BxB,IAAAA,gBAAgB,CAACwB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAhB;AACAxB,IAAAA,mBAAmB,CAAC,EAAD,CAAnB;AACAE,IAAAA,aAAa,CAAC,EAAD,CAAb,CAH0B,CAK1B;;AACA,QAAMuB,aAAa,GAAGlC,KAAK,CAACmC,IAAN,CAAW,UAACZ,IAAD;AAAA,aAAUA,IAAI,CAACC,QAAL,KAAkBO,CAAC,CAACC,MAAF,CAASC,KAArC;AAAA,KAAX,CAAtB;;AACA,QAAIC,aAAJ,EAAmB;AACf,UAAME,GAAG,GAAGC,UAAU,CAACH,aAAa,CAACI,gBAAf,CAAtB;AACA,UAAMC,GAAG,GAAGF,UAAU,CAACH,aAAa,CAACM,iBAAf,CAAtB,CAFe,CAGf;;AACAC,MAAAA,QAAQ,CAAC,UAACC,IAAD;AAAA,+CACFA,IADE;AAELC,UAAAA,MAAM,EAAE;AAAEP,YAAAA,GAAG,EAAHA,GAAF;AAAOG,YAAAA,GAAG,EAAHA;AAAP;AAFH;AAAA,OAAD,CAAR;AAIH,KAfyB,CAgB1B;;;AACA1B,IAAAA,gBAAgB,CAAC,EAAD,CAAhB;AACAK,IAAAA,cAAc,CAAC,CAAD,CAAd;AACH,GAzCkC,CA2CnC;;;AACA,WAAS0B,oBAAT,CAA8Bb,CAA9B,EAAiC;AAC7BtB,IAAAA,mBAAmB,CAACsB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAnB;AACH,GA9CkC,CAgDnC;;;AACA,WAASY,sBAAT,CAAgCd,CAAhC,EAAmC;AAC/BpB,IAAAA,aAAa,CAACoB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAb,CAD+B,CAE/B;;AACApB,IAAAA,gBAAgB,CAAC,EAAD,CAAhB;AACAK,IAAAA,cAAc,CAAC,CAAD,CAAd;AACH;;AAED,WAAS4B,uBAAT,GAAmC;AAC/B;AACA,QAAIC,OAAO,sBAAO/C,KAAP,CAAX,CAF+B,CAI/B;;;AACA,QAAIM,aAAJ,EAAmB;AACfyC,MAAAA,OAAO,GAAGA,OAAO,CAACzB,MAAR,CAAe,UAACC,IAAD;AAAA,eAAUA,IAAI,CAACC,QAAL,KAAkBlB,aAA5B;AAAA,OAAf,CAAV;AACH,KAP8B,CAS/B;;;AACA,QAAIE,gBAAJ,EAAsB;AAClBuC,MAAAA,OAAO,GAAGA,OAAO,CAACzB,MAAR,CAAe,UAACC,IAAD;AAAA,eAAUA,IAAI,CAACK,YAAL,KAAsBpB,gBAAhC;AAAA,OAAf,CAAV;AACH,KAZ8B,CAa/B;;;AACA,QAAIE,UAAJ,EAAgB;AACZqC,MAAAA,OAAO,GAAGA,OAAO,CAACzB,MAAR,CAAe,UAACC,IAAD;AAAA,eAAUA,IAAI,CAACyB,QAAL,CAAcC,QAAd,CAAuBvC,UAAvB,CAAV;AAAA,OAAf,CAAV;AACH;;AACD,QAAIqC,OAAO,CAAC/B,MAAR,KAAmB,CAAvB,EAA0BZ,OAAO,CAAC,IAAD,CAAP,CAA1B,KACI;AACJS,MAAAA,gBAAgB,CAACkC,OAAD,CAAhB;AACA7B,MAAAA,cAAc,CAAC6B,OAAO,CAAC/B,MAAT,CAAd;AACC;AACJ;;AA9EkC,mBAiFT/B,QAAQ,CAAC;AAC/B0D,IAAAA,MAAM,EAAE;AACJP,MAAAA,GAAG,EAAE,iBADD;AAEJG,MAAAA,GAAG,EAAE;AAFD,KADuB;AAK/BW,IAAAA,MAAM,EAAE,IALuB;AAM/BC,IAAAA,SAAS,EAAE;AANoB,GAAD,CAjFC;AAAA,MAiF5BC,KAjF4B;AAAA,MAiFrBX,QAjFqB;;AA0FnCzD,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAIqE,SAAS,CAACC,WAAd,EAA2B;AACvB;AACAD,MAAAA,SAAS,CAACC,WAAV,CAAsBC,kBAAtB,CACI,UAACC,QAAD,EAAc;AACVf,QAAAA,QAAQ,CAAC,UAACC,IAAD;AAAA,iDACFA,IADE;AAELC,YAAAA,MAAM,EAAE;AACJP,cAAAA,GAAG,EAAEoB,QAAQ,CAACC,MAAT,CAAgBC,QADjB;AAC2B;AAC/BnB,cAAAA,GAAG,EAAEiB,QAAQ,CAACC,MAAT,CAAgBE,SAFjB,CAE4B;;AAF5B,aAFH;AAMLR,YAAAA,SAAS,EAAE;AANN;AAAA,SAAD,CAAR;AAQH,OAVL,EAWI,UAACS,GAAD,EAAS;AACLnB,QAAAA,QAAQ,CAAC,UAACC,IAAD;AAAA,iDACFA,IADE;AAELQ,YAAAA,MAAM,EAAEU,GAAG,CAACC,OAFP;AAGLV,YAAAA,SAAS,EAAE;AAHN;AAAA,SAAD,CAAR;AAKH,OAjBL;AAmBH,KArBD,MAqBO;AACH;AACAV,MAAAA,QAAQ,CAAC,UAACC,IAAD;AAAA,+CACFA,IADE;AAELQ,UAAAA,MAAM,EAAE,yBAFH;AAGLC,UAAAA,SAAS,EAAE;AAHN;AAAA,OAAD,CAAR;AAKH;AACJ,GA9BQ,EA8BN,EA9BM,CAAT;AAiCA,SACI,MAAC,SAAD;AAAW,IAAA,SAAS,EAAC,wBAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAMlC,WAAN,WADJ,EAEKL,aAAa,CAACe,GAAd,CAAkB,UAACJ,IAAD;AAAA,WACf,MAAC,IAAD;AACI,MAAA,GAAG,EAAEA,IAAI,CAACyB,QADd;AAEI,MAAA,KAAK,EAAEzB,IAAI,CAACyB,QAFhB;AAGI,MAAA,MAAM,EAAE,MAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHZ;AAII,MAAA,IAAI,EAAEzB,IAAI,CAACuC,kBAJf;AAKI,MAAA,GAAG,EAAC,cALR;AAMI,MAAA,SAAS,EAAE,qBAAM;AACb/C,QAAAA,gBAAgB,CAACQ,IAAD,CAAhB;AACArB,QAAAA,SAAS,CAAC,IAAD,CAAT;AACA,YAAMkC,GAAG,GAAGC,UAAU,CAACd,IAAI,CAACe,gBAAN,CAAtB;AACA,YAAMC,GAAG,GAAGF,UAAU,CAACd,IAAI,CAACiB,iBAAN,CAAtB;AACAC,QAAAA,QAAQ,CAAC,UAACC,IAAD;AAAA,iDACFA,IADE;AAELC,YAAAA,MAAM,EAAE;AAAEP,cAAAA,GAAG,EAAHA,GAAF;AAAOG,cAAAA,GAAG,EAAHA;AAAP;AAFH;AAAA,SAAD,CAAR;AAIH,OAfL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADe;AAAA,GAAlB,CAFL,CADJ,EAwBI;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,IAAD;AAAM,IAAA,SAAS,EAAC,aAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,UAAD;AAAY,IAAA,KAAK,EAAEjC,aAAnB;AAAkC,IAAA,QAAQ,EAAEwB,iBAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAQ,IAAA,KAAK,EAAC,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,EAGK,mBAAI,IAAIJ,GAAJ,CAAQ1B,KAAK,CAAC2B,GAAN,CAAU,UAACJ,IAAD;AAAA,WAAUA,IAAI,CAACC,QAAf;AAAA,GAAV,CAAR,CAAJ,EAAiDG,GAAjD,CAAqD,UAACP,KAAD;AAAA,WAClD;AAAQ,MAAA,GAAG,EAAEA,KAAb;AAAoB,MAAA,KAAK,EAAEA,KAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAmCA,KAAnC,CADkD;AAAA,GAArD,CAHL,CADJ,EAQKd,aAAa,GACV,MAAC,UAAD;AAAY,IAAA,KAAK,EAAEE,gBAAnB;AAAqC,IAAA,QAAQ,EAAEoC,oBAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAQ,IAAA,KAAK,EAAC,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCADJ,EAEKzB,kBAAkB,CAACb,aAAD,CAFvB,CADU,GAMV,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCADJ,CAdR,EAkBI,MAAC,IAAD,CAAM,OAAN;AACI,IAAA,IAAI,EAAC,MADT;AAEI,IAAA,WAAW,EAAC,oDAFhB;AAGI,IAAA,KAAK,EAAEI,UAHX;AAII,IAAA,QAAQ,EAAEmC,sBAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAlBJ,EAwBI,MAAC,MAAD;AAAQ,IAAA,OAAO,EAAEC,uBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAxBJ,CADJ,EA4BA,MAAC,GAAD;AAAK,IAAA,MAAM,EAAEM,KAAK,CAACT,MAAnB;AAA2B,IAAA,KAAK,EAAE;AAAEoB,MAAAA,KAAK,EAAE,MAAT;AAAiBC,MAAAA,MAAM,EAAE;AAAzB,KAAlC;AAAuE,IAAA,KAAK,EAAE,CAA9E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACK,CAAC,CAACZ,KAAK,CAACD,SAAP,GAAmBvC,aAAnB,GAAmC,EAApC,EAAwCe,GAAxC,CAA4C,UAACJ,IAAD;AAAA,WACzC,MAAC,SAAD;AACI,MAAA,GAAG,EAAEA,IAAI,CAACyB,QADd;AAEI,MAAA,QAAQ,EAAE;AAAEZ,QAAAA,GAAG,EAAEb,IAAI,CAACe,gBAAZ;AAA8BC,QAAAA,GAAG,EAAEhB,IAAI,CAACiB;AAAxC,OAFd;AAGI,MAAA,OAAO,EAAE,mBAAM;AACXzB,QAAAA,gBAAgB,CAACQ,IAAD,CAAhB;AACArB,QAAAA,SAAS,CAAC,IAAD,CAAT;AACH,OANL;AAOI,MAAA,KAAK,EAAE;AACH+D,QAAAA,GAAG,YAAK5E,OAAL,CADA;AAEH6E,QAAAA,IAAI,EAAE;AAACH,UAAAA,KAAK,EAAE,EAAR;AAAYC,UAAAA,MAAM,EAAE;AAApB,SAFH;AAGHG,QAAAA,OAAO,EAAE;AACRC,UAAAA,MAAM,EAAE;AAACC,YAAAA,CAAC,EAAE,EAAJ;AAAQC,YAAAA,CAAC,EAAE;AAAX;AADA;AAHN,OAPX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADyC;AAAA,GAA5C,CADL,CA5BA,CAxBJ,EAwEI,MAAC,UAAD;AACI,IAAA,IAAI,EAAC,IADT;AAEI,IAAA,MAAM,EAAErE,MAFZ;AAGI,IAAA,SAAS,EAAEC,SAHf;AAII,IAAA,KAAK,EAAE,CAJX;AAKI,IAAA,KAAK,EAAEY,aAAa,GAAGA,aAAa,CAACkC,QAAjB,GAA4B,EALpD;AAMI,IAAA,IAAI,EAAElC,aAAa,GAAGA,aAAa,CAACgD,kBAAjB,GAAsC,EAN7D;AAOI,IAAA,OAAO,EAAEhD,aAAa,GAAGA,aAAa,CAACyD,SAAjB,GAA6B,EAPvD;AAQI,IAAA,GAAG,EAAElE,GART;AASI,IAAA,GAAG,EAAEjB,GATT;AAUI,IAAA,GAAG,EAAE0B,aAAa,GAAGA,aAAa,CAACwB,gBAAjB,GAAoC,IAV1D;AAWI,IAAA,GAAG,EAAExB,aAAa,GAAGA,aAAa,CAAC0B,iBAAjB,GAAqC,IAX3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAxEJ,EAqFI,MAAC,KAAD;AAAO,aAAM,aAAb;AAA2B,IAAA,IAAI,EAAC,IAAhC;AAAqC,IAAA,MAAM,EAAErC,IAA7C;AAAmD,IAAA,SAAS,EAAEC,OAA9D;AAAuE,IAAA,QAAQ,EAAC,uEAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IArFJ,CADJ;AAyFH;;GApNuBL,K;;MAAAA,K;AAsNxBT,SAAS,CAACS,KAAD,EAAO;AAACyE,EAAAA,KAAK,EAAC,oBAAP;AAA4BC,EAAAA,WAAW,EAAC;AAAxC,CAAP,CAAT","sourcesContent":["import {Button, Container, Form, FormSelect} from \"react-bootstrap\";\r\nimport List from \"../components/list\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { AiTwotoneHeart } from \"react-icons/ai\";\r\nimport PlaceModal from \"./place_modal\";\r\nimport img from '../assets/workaut.png';\r\nimport mapicon from '../assets/map-icon.png';\r\nimport getLayout from \"../components/layouts/getLayout\";\r\n\r\nimport Modal from \"../components/modal\";\r\nimport {Datas} from \"../pages/feutils\";\r\n\r\nimport dynamic from 'next/dynamic';\r\n\r\nimport kakaoShare from \"../services/kakaoShare\";\r\nconst Map = dynamic(() => import(\"react-kakao-maps-sdk\").then((module) => module.Map), {\r\n    ssr: false\r\n});\r\nconst MapMarker = dynamic(() => import(\"react-kakao-maps-sdk\").then((module) => module.MapMarker), {\r\n    ssr: false\r\n});\r\n\r\nexport async function getServerSideProps(ctx) {\r\n    let items = await Datas('/main?srch=');\r\n    return {props: {items: items}}\r\n}\r\n\r\nexport default function Index({items}) {\r\n    const [lgShow, setLgShow] = useState(false);\r\n    const [show, setShow] = useState(false);\r\n\r\n    let des = '#에어로빅 #줌바 #조깅';\r\n\r\n    const [selectedSigun, setSelectedSigun] = useState(\"\");\r\n    const [selectedFacility, setSelectedFacility] = useState(\"\");\r\n    const [searchText, setSearchText] = useState(\"\");\r\n    const [searchResults, setSearchResults] = useState(items);  // 검색결과 저장 state\r\n    const [selectedPlace, setSelectedPlace] = useState(null);   // 마커 클릭시 모달 state\r\n    const [searchCount, setSearchCount] = useState(items.length);  // 총 몇개의 시설이 조회된건지 저장하는 state\r\n\r\n\r\n    // 시군명 선택 시 시설구분명 셀렉트 태그에 표시할 options 배열 반환\r\n    function getFacilityOptions(sigun) {\r\n        const facilities = items.filter((item) => item.SIGUN_NM === sigun);\r\n        const facilityNames = [...new Set(facilities.map((item) => item.FACLT_DIV_NM))];\r\n        return facilityNames.map((name) => <option key={name}>{name}</option>);\r\n    }\r\n\r\n    // 시군명 선택 시 시설구분명 셀렉트 태그 업데이트 및 지도 중심좌표 설정\r\n    function handleSigunChange(e) {\r\n        setSelectedSigun(e.target.value);\r\n        setSelectedFacility(\"\");\r\n        setSearchText(\"\");\r\n\r\n        // 시설 데이터 중 첫번째 시설의 위도와 경도 정보 가져오기\r\n        const firstFacility = items.find((item) => item.SIGUN_NM === e.target.value);\r\n        if (firstFacility) {\r\n            const lat = parseFloat(firstFacility.REFINE_WGS84_LAT);\r\n            const lng = parseFloat(firstFacility.REFINE_WGS84_LOGT);\r\n            // 위도와 경도 정보로 중심 좌표 설정\r\n            setState((prev) => ({\r\n                ...prev,\r\n                center: { lat, lng },\r\n            }));\r\n        }\r\n        // 검색 결과 초기화\r\n        setSearchResults([]);\r\n        setSearchCount(0);\r\n    }\r\n\r\n    // 시설구분명 선택 시 state 업데이트\r\n    function handleFacilityChange(e) {\r\n        setSelectedFacility(e.target.value);\r\n    }\r\n\r\n    // 검색어 입력 시 state 업데이트\r\n    function handleSearchTextChange(e) {\r\n        setSearchText(e.target.value);\r\n        // 검색 결과 초기화\r\n        setSearchResults([]);\r\n        setSearchCount(0);\r\n    }\r\n\r\n    function handleSearchButtonClick() {\r\n        // items 객체 복사\r\n        let results = [...items];\r\n\r\n        // 선택된 시군명이 있다면, 해당 시군명에 해당하는 시설들만 필터링\r\n        if (selectedSigun) {\r\n            results = results.filter((item) => item.SIGUN_NM === selectedSigun);\r\n        }\r\n\r\n        // 선택된 시설구분명이 있다면, 해당 시설구분명에 해당하는 시설들만 필터링\r\n        if (selectedFacility) {\r\n            results = results.filter((item) => item.FACLT_DIV_NM === selectedFacility);\r\n        }\r\n        // 검색어가 있다면, 시설명이 해당 검색어를 포함하는 시설들만 필터링\r\n        if (searchText) {\r\n            results = results.filter((item) => item.FACLT_NM.includes(searchText));\r\n        }\r\n        if (results.length === 0) setShow(true)\r\n        else{\r\n        setSearchResults(results);\r\n        setSearchCount(results.length);\r\n        }\r\n    }\r\n\r\n\r\n    const [state, setState] = useState({\r\n        center: {\r\n            lat: 37.28892227326957,\r\n            lng: 127.05363481102465,\r\n        },\r\n        errMsg: null,\r\n        isLoading: true,\r\n    })\r\n\r\n    useEffect(() => {\r\n        if (navigator.geolocation) {\r\n            // GeoLocation을 이용해서 접속 위치를 얻어옵니다\r\n            navigator.geolocation.getCurrentPosition(\r\n                (position) => {\r\n                    setState((prev) => ({\r\n                        ...prev,\r\n                        center: {\r\n                            lat: position.coords.latitude, // 위도\r\n                            lng: position.coords.longitude, // 경도\r\n                        },\r\n                        isLoading: false,\r\n                    }))\r\n                },\r\n                (err) => {\r\n                    setState((prev) => ({\r\n                        ...prev,\r\n                        errMsg: err.message,\r\n                        isLoading: false,\r\n                    }))\r\n                }\r\n            )\r\n        } else {\r\n            // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다\r\n            setState((prev) => ({\r\n                ...prev,\r\n                errMsg: \"geolocation을 사용할수 없어요..\",\r\n                isLoading: false,\r\n            }))\r\n        }\r\n    }, [])\r\n\r\n\r\n    return(\r\n        <Container className=\"d-flex mt-4 mb-4 index\">\r\n            <div className=\"left col-6 \">\r\n                <p>총 {searchCount}건</p>\r\n                {searchResults.map((item) => (\r\n                    <List\r\n                        key={item.FACLT_NM}\r\n                        title={item.FACLT_NM}\r\n                        malcnt={<AiTwotoneHeart />}\r\n                        note={item.REFINE_ROADNM_ADDR}\r\n                        col=\"bg-secondary\"\r\n                        textClick={() => {\r\n                            setSelectedPlace(item);\r\n                            setLgShow(true);\r\n                            const lat = parseFloat(item.REFINE_WGS84_LAT);\r\n                            const lng = parseFloat(item.REFINE_WGS84_LOGT);\r\n                            setState((prev) => ({\r\n                                ...prev,\r\n                                center: { lat, lng },\r\n                            }));\r\n                        }}\r\n                    />\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"right col-6 ms-4\">\r\n                <Form className=\"d-flex mb-2\">\r\n                    <FormSelect value={selectedSigun} onChange={handleSigunChange}>\r\n                        <option value=\"\">시군</option>\r\n                        {/* API에서 불러오는 데이터중 시군 데이터로 새로운 배열을 생성하되 중복을 제거함 */}\r\n                        {[...new Set(items.map((item) => item.SIGUN_NM))].map((sigun) => (\r\n                            <option key={sigun} value={sigun}>{sigun}</option>\r\n                        ))}\r\n                    </FormSelect>\r\n                    {selectedSigun ? (\r\n                        <FormSelect value={selectedFacility} onChange={handleFacilityChange}>\r\n                            <option value=\"\">시설구분명</option>\r\n                            {getFacilityOptions(selectedSigun)}\r\n                        </FormSelect>\r\n                    ) : (\r\n                        <FormSelect >\r\n                            <option>시설구분명</option>\r\n                        </FormSelect>\r\n                    )}\r\n                    <Form.Control\r\n                        type=\"text\"\r\n                        placeholder=\"어디서 운동할까요?\"\r\n                        value={searchText}\r\n                        onChange={handleSearchTextChange}\r\n                    />\r\n                    <Button onClick={handleSearchButtonClick}>Search</Button>\r\n                </Form>\r\n\r\n            <Map center={state.center} style={{ width: \"100%\", height: \"800px\" }}  level={3}>\r\n                {(!state.isLoading ? searchResults : []).map((item) => (\r\n                    <MapMarker\r\n                        key={item.FACLT_NM}\r\n                        position={{ lat: item.REFINE_WGS84_LAT, lng: item.REFINE_WGS84_LOGT }}\r\n                        onClick={() => {\r\n                            setSelectedPlace(item);\r\n                            setLgShow(true);\r\n                        }}\r\n                        image={{\r\n                            src: `${mapicon}`,\r\n                            size: {width: 30, height: 30,},\r\n                            options: {\r\n                             offset: {x: 27, y: 69,},\r\n                        },\r\n                        }}\r\n                    />\r\n                ))}\r\n            </Map>\r\n            </div>\r\n            <PlaceModal\r\n                size=\"lg\"\r\n                lgShow={lgShow}\r\n                setLgShow={setLgShow}\r\n                score={3}\r\n                title={selectedPlace ? selectedPlace.FACLT_NM : \"\"}\r\n                addr={selectedPlace ? selectedPlace.REFINE_ROADNM_ADDR : \"\"}\r\n                contact={selectedPlace ? selectedPlace.CONTCT_NO : \"\"}\r\n                des={des}\r\n                img={img}\r\n                lat={selectedPlace ? selectedPlace.REFINE_WGS84_LAT : null}\r\n                lng={selectedPlace ? selectedPlace.REFINE_WGS84_LOGT : null}\r\n            />\r\n            <Modal class=\"searchModal\" size=\"sm\" lgShow={show} setLgShow={setShow} children=\"해당하는 시설이 없습니다.\"/>\r\n        </Container>\r\n    )\r\n}\r\n\r\ngetLayout(Index,{title:'주변에서 운동해요! WAKAUT!',description:'신개념 운동 플랫폼 워크아웃!'})\r\n"]},"metadata":{},"sourceType":"module"}