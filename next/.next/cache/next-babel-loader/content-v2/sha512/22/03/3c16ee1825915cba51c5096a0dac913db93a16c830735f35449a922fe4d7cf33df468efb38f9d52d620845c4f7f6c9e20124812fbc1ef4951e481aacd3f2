{"ast":null,"code":"// npm install next-auth@3.29.10 --save-dev\nimport NextAuth from \"next-auth\";\nimport Credentials from 'next-auth/providers/credentials';\nimport axios from \"axios\";\nimport KakaoProvider from 'next-auth/providers/kakao';\nexport default NextAuth({\n  providers: [KakaoProvider({\n    clientId: process.env.KAKAO_CLIENT_ID || '',\n    clientSecret: 'ERMSDHsOwUhONXGC0PQlgp4jNQnUNdp0' || ''\n  }, function () {\n    console.log('성공!');\n  }), Credentials({\n    id: \"userid-passwd-credentials\",\n    name: \"userid-passwd-credentials\",\n    credentials: {\n      userid: {\n        label: \"아이디\",\n        type: \"text\"\n      },\n      passwd: {\n        label: \"비밀번호\",\n        type: \"password\"\n      }\n    },\n\n    // 로그인 폼 정의\n    async authorize(credentials, req) {\n      const userid = credentials.userid;\n      const passwd = credentials.passwd; // 인증 확인\n\n      let params = [userid, passwd];\n      let url = `http://localhost:3000/api/users/login?userid=${params[0]}&passwd=${params[1]}`;\n      const res = await axios.get(url);\n      const result = await res.data; // 인증 성공시 반환\n\n      if ((await result).uid > 0) {\n        return result;\n      }\n    }\n\n  })],\n  pages: {\n    // 인증에 사용자 정의 로그인 페이지 사용\n    signIn: '/member/login'\n  },\n  callbacks: {\n    async jwt(token, user, account, profile, isNewUser) {\n      if (user !== null && user !== void 0 && user.userid) token.userid = user.userid;\n      return token;\n    },\n\n    async session(session, userOrToken) {\n      userOrToken.userid ? session.user.userid = userOrToken.userid : session.user.userid = parseInt(userOrToken.sub);\n      console.log('세션값', session);\n      return session;\n    }\n\n  }\n});","map":{"version":3,"sources":["C:/Users/pc/Desktop/학언/WAKAUT/next/pages/api/auth/[...nextauth].js"],"names":["NextAuth","Credentials","axios","KakaoProvider","providers","clientId","process","env","KAKAO_CLIENT_ID","clientSecret","console","log","id","name","credentials","userid","label","type","passwd","authorize","req","params","url","res","get","result","data","uid","pages","signIn","callbacks","jwt","token","user","account","profile","isNewUser","session","userOrToken","parseInt","sub"],"mappings":"AAAA;AACA,OAAOA,QAAP,MAAqB,WAArB;AACA,OAAOC,WAAP,MAAwB,iCAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,aAAP,MAA0B,2BAA1B;AAEA,eAAeH,QAAQ,CAAC;AACpBI,EAAAA,SAAS,EAAE,CACPD,aAAa,CAAC;AACVE,IAAAA,QAAQ,EAAEC,OAAO,CAACC,GAAR,CAAYC,eAAZ,IAA6B,EAD7B;AAEVC,IAAAA,YAAY,EAAC,sCAAoC;AAFvC,GAAD,EAIb,YAAU;AACNC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACH,GANY,CADN,EAQPV,WAAW,CAAC;AACRW,IAAAA,EAAE,EAAE,2BADI;AAERC,IAAAA,IAAI,EAAE,2BAFE;AAGRC,IAAAA,WAAW,EAAE;AACTC,MAAAA,MAAM,EAAE;AAAEC,QAAAA,KAAK,EAAE,KAAT;AAAgBC,QAAAA,IAAI,EAAE;AAAtB,OADC;AAETC,MAAAA,MAAM,EAAE;AAAEF,QAAAA,KAAK,EAAE,MAAT;AAAiBC,QAAAA,IAAI,EAAE;AAAvB;AAFC,KAHL;;AAML;AACH,UAAME,SAAN,CAAgBL,WAAhB,EAA6BM,GAA7B,EAAkC;AAC9B,YAAML,MAAM,GAAGD,WAAW,CAACC,MAA3B;AACA,YAAMG,MAAM,GAAGJ,WAAW,CAACI,MAA3B,CAF8B,CAG9B;;AACA,UAAIG,MAAM,GAAG,CAACN,MAAD,EAAQG,MAAR,CAAb;AACA,UAAII,GAAG,GAAG,gDAA+CD,MAAM,CAAC,CAAD,CAAI,WAAUA,MAAM,CAAC,CAAD,CAAI,EAAvF;AACA,YAAME,GAAG,GAAE,MAAMrB,KAAK,CAACsB,GAAN,CAAUF,GAAV,CAAjB;AACA,YAAMG,MAAM,GAAI,MAAMF,GAAG,CAACG,IAA1B,CAP8B,CAQ9B;;AACA,UAAG,CAAC,MAAMD,MAAP,EAAeE,GAAf,GAAqB,CAAxB,EAA0B;AACtB,eAAOF,MAAP;AACH;AAEJ;;AApBO,GAAD,CARJ,CADS;AAgCpBG,EAAAA,KAAK,EAAE;AAAE;AACLC,IAAAA,MAAM,EAAE;AADL,GAhCa;AAmCpBC,EAAAA,SAAS,EAAE;AACP,UAAMC,GAAN,CAAUC,KAAV,EAAiBC,IAAjB,EAAuBC,OAAvB,EAAgCC,OAAhC,EAAyCC,SAAzC,EAAoD;AAChD,UAAIH,IAAJ,aAAIA,IAAJ,eAAIA,IAAI,CAAElB,MAAV,EAAkBiB,KAAK,CAACjB,MAAN,GAAekB,IAAI,CAAClB,MAApB;AAClB,aAAOiB,KAAP;AACH,KAJM;;AAKP,UAAMK,OAAN,CAAcA,OAAd,EAAuBC,WAAvB,EAAoC;AAC/BA,MAAAA,WAAW,CAACvB,MAAb,GAAsBsB,OAAO,CAACJ,IAAR,CAAalB,MAAb,GAAsBuB,WAAW,CAACvB,MAAxD,GAA+DsB,OAAO,CAACJ,IAAR,CAAalB,MAAb,GAAsBwB,QAAQ,CAACD,WAAW,CAACE,GAAb,CAA7F;AACA9B,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmB0B,OAAnB;AACA,aAAOA,OAAP;AACH;;AATM;AAnCS,CAAD,CAAvB","sourcesContent":["// npm install next-auth@3.29.10 --save-dev\r\nimport NextAuth from \"next-auth\";\r\nimport Credentials from 'next-auth/providers/credentials';\r\nimport axios from \"axios\";\r\nimport KakaoProvider from 'next-auth/providers/kakao'\r\n\r\nexport default NextAuth({\r\n    providers: [\r\n        KakaoProvider({\r\n            clientId: process.env.KAKAO_CLIENT_ID||'',\r\n            clientSecret:'ERMSDHsOwUhONXGC0PQlgp4jNQnUNdp0'||'',\r\n        },\r\n        function(){\r\n            console.log('성공!');\r\n        }),\r\n        Credentials({\r\n            id: \"userid-passwd-credentials\",\r\n            name: \"userid-passwd-credentials\",\r\n            credentials: {\r\n                userid: { label: \"아이디\", type: \"text\" },\r\n                passwd: { label: \"비밀번호\", type: \"password\" },\r\n            }, // 로그인 폼 정의\r\n            async authorize(credentials, req) {\r\n                const userid = credentials.userid;\r\n                const passwd = credentials.passwd;\r\n                // 인증 확인\r\n                let params = [userid,passwd];\r\n                let url =`http://localhost:3000/api/users/login?userid=${params[0]}&passwd=${params[1]}`;\r\n                const res= await axios.get(url);\r\n                const result  = await res.data;\r\n                // 인증 성공시 반환\r\n                if((await result).uid > 0){\r\n                    return result;\r\n                }\r\n\r\n            }\r\n        })\r\n    ],\r\n    pages: { // 인증에 사용자 정의 로그인 페이지 사용\r\n        signIn: '/member/login'\r\n    },\r\n    callbacks: {\r\n        async jwt(token, user, account, profile, isNewUser) {\r\n            if (user?.userid) token.userid = user.userid;\r\n            return token;  \r\n        },\r\n        async session(session, userOrToken) {\r\n            (userOrToken.userid)? session.user.userid = userOrToken.userid:session.user.userid = parseInt(userOrToken.sub)\r\n            console.log('세션값', session);\r\n            return session;\r\n        }\r\n    }\r\n});"]},"metadata":{},"sourceType":"module"}