{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\fullstack\\\\Desktop\\\\TeamWorks\\\\WAKAUT\\\\next\\\\pages\\\\index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Button, Container, Form, FormSelect } from \"react-bootstrap\";\nimport List from \"../components/list\";\nimport { useEffect, useState } from \"react\";\nimport { AiTwotoneHeart } from \"react-icons/ai\";\nimport PlaceModal from \"./place_modal\";\nimport img from '../assets/workaut.png';\nimport mapicon from '../assets/map-icon.png';\nimport getLayout from \"../components/layouts/getLayout\";\nimport Modal from \"../components/modal\";\nimport { Datas } from \"../components/feutils\";\nimport { handleFacilityChange, handleSearchButtonClick, handleSearchTextChange, handleShowAll, handleSigunChange } from \"../models/Utils\";\nimport dynamic from 'next/dynamic';\nconst Map = dynamic(() => import(\"react-kakao-maps-sdk\").then(module => module.Map), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"react-kakao-maps-sdk\")],\n    modules: [\"index.js -> \" + \"react-kakao-maps-sdk\"]\n  }\n});\nconst MapMarker = dynamic(() => import(\"react-kakao-maps-sdk\").then(module => module.MapMarker), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"react-kakao-maps-sdk\")],\n    modules: [\"index.js -> \" + \"react-kakao-maps-sdk\"]\n  }\n});\nexport async function getServerSideProps(ctx) {\n  const word = ctx.query.word || '';\n  let items = await Datas('/main', `srch=${word}`);\n  return {\n    props: {\n      items: items,\n      word: word\n    }\n  };\n}\nexport default function Index({\n  items,\n  word\n}) {\n  let des = '#에어로빅 #줌바 #조깅';\n  const {\n    0: lgShow,\n    1: setLgShow\n  } = useState(false);\n  const {\n    0: show,\n    1: setShow\n  } = useState(false);\n  const {\n    0: selectedSigun,\n    1: setSelectedSigun\n  } = useState(\"\");\n  const {\n    0: selectedFacility,\n    1: setSelectedFacility\n  } = useState(\"\");\n  const {\n    0: searchText,\n    1: setSearchText\n  } = useState(\"\");\n  const {\n    0: searchResults,\n    1: setSearchResults\n  } = useState(items); // 검색결과 저장 state\n\n  const {\n    0: selectedPlace,\n    1: setSelectedPlace\n  } = useState(null); // 마커 클릭시 모달 state\n\n  const {\n    0: searchCount,\n    1: setSearchCount\n  } = useState(items.length); // 총 몇개의 시설이 조회된건지 저장하는 state\n\n  const {\n    0: isButtonActive,\n    1: setIsButtonActive\n  } = useState(false);\n  const {\n    0: bdList,\n    1: setBDLists\n  } = useState({}); // 시군명 선택 시 시설구분명 셀렉트 태그에 표시할 options 배열 반환\n\n  function getFacilityOptions(sigun) {\n    const facilities = items.filter(item => item.SIGUN_NM === sigun);\n    const facilityNames = [...new Set(facilities.map(item => item.FACLT_DIV_NM))];\n    return facilityNames.map(name => __jsx(\"option\", {\n      key: name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 44\n      }\n    }, name));\n  }\n\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    center: {\n      lat: 37.28892227326957,\n      lng: 127.05363481102465\n    },\n    errMsg: null,\n    isLoading: true\n  }); // useEffect는 최초 렌더링 이후에 실행됩니다. useEffect의 첫 번째 인자로 전달한\n  // 함수는 컴포넌트가 마운트(처음으로 렌더링)된 이후에 한번 실행되며, 두 번째 인자로\n  // 전달한 배열에 지정한 값이 변경되었을 때에도 실행됩니다.\n\n  useEffect(() => {\n    if (navigator.geolocation) {\n      // GeoLocation을 이용해서 접속 위치를 얻어옵니다\n      navigator.geolocation.getCurrentPosition(position => {\n        setState(prev => _objectSpread(_objectSpread({}, prev), {}, {\n          center: {\n            lat: position.coords.latitude,\n            // 위도\n            lng: position.coords.longitude // 경도\n\n          },\n          isLoading: false\n        }));\n      }, err => {\n        setState(prev => _objectSpread(_objectSpread({}, prev), {}, {\n          errMsg: err.message,\n          isLoading: false\n        }));\n      });\n    } else {\n      // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다\n      setState(prev => _objectSpread(_objectSpread({}, prev), {}, {\n        errMsg: \"geolocation을 사용할수 없어요..\",\n        isLoading: false\n      }));\n    }\n  }, []); // 게시글 목록 가지고 오기\n\n  async function lists(fcname) {\n    let boards = await Datas('/board/boardlist', `pg=5&fcname=${fcname}`).then(r => r);\n    setBDLists(await boards);\n  }\n\n  return __jsx(Container, {\n    className: \"d-flex mt-4 mb-4 index\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"left col-6 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, \"\\uCD1D \", searchCount, \"\\uAC74\"), searchResults.map(item => __jsx(List, {\n    key: item.FACLT_NM,\n    title: item.FACLT_NM,\n    malcnt: __jsx(AiTwotoneHeart, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 33\n      }\n    }),\n    note: item.REFINE_ROADNM_ADDR,\n    col: \"bg-secondary\",\n    textClick: () => {\n      setSelectedPlace(item);\n      setLgShow(true);\n      const lat = parseFloat(item.REFINE_WGS84_LAT);\n      const lng = parseFloat(item.REFINE_WGS84_LOGT);\n      setState(prev => _objectSpread(_objectSpread({}, prev), {}, {\n        center: {\n          lat,\n          lng\n        }\n      }));\n      lists(item.FACLT_NM);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }))), __jsx(\"div\", {\n    className: \"right col-6 ms-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, word ? __jsx(Button, {\n    className: \"showAll-btn mb-2\",\n    variant: \"outline-success\",\n    onClick: handleShowAll,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 25\n    }\n  }, \"\\uC804\\uCCB4 \\uC2DC\\uC124\\uBCF4\\uAE30\") : false, __jsx(Form, {\n    className: \"d-flex mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, __jsx(FormSelect, {\n    value: selectedSigun,\n    onChange: e => handleSigunChange(e, setSelectedSigun, setSelectedFacility, setSearchText, items, setState, setSearchResults, setSearchCount),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 21\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 25\n    }\n  }, \"\\uC2DC\\uAD70\"), [...new Set(items.map(item => item.SIGUN_NM))].map(sigun => __jsx(\"option\", {\n    key: sigun,\n    value: sigun,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 33\n    }\n  }, sigun))), selectedSigun ? __jsx(FormSelect, {\n    value: selectedFacility,\n    onChange: e => handleFacilityChange(e, setSelectedFacility),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 29\n    }\n  }, \"\\uC2DC\\uC124\\uAD6C\\uBD84\\uBA85\"), getFacilityOptions(selectedSigun)) : __jsx(FormSelect, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 29\n    }\n  }, \"\\uC2DC\\uC124\\uAD6C\\uBD84\\uBA85\")), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"\\uC5B4\\uB514\\uC11C \\uC6B4\\uB3D9\\uD560\\uAE4C\\uC694?\",\n    value: searchText,\n    onChange: e => handleSearchTextChange(e, setSearchText, setSearchResults, setSearchCount, setIsButtonActive),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  }), __jsx(Button, {\n    className: \"facility-btn\",\n    variant: \"outline-success\",\n    active: isButtonActive,\n    onClick: () => handleSearchButtonClick(items, selectedSigun, selectedFacility, searchText, setShow, setSearchResults, setSearchCount),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }, \"Search\")), __jsx(Map, {\n    center: state.center,\n    style: {\n      width: \"100%\",\n      height: \"800px\"\n    },\n    level: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }\n  }, (!state.isLoading ? searchResults : []).map(item => __jsx(MapMarker, {\n    key: item.FACLT_NM,\n    position: {\n      lat: item.REFINE_WGS84_LAT,\n      lng: item.REFINE_WGS84_LOGT\n    },\n    onClick: () => {\n      setSelectedPlace(item);\n      setLgShow(true);\n    },\n    image: {\n      src: `${mapicon}`,\n      size: {\n        width: 30,\n        height: 30\n      },\n      options: {\n        offset: {\n          x: 27,\n          y: 69\n        }\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 21\n    }\n  })))), __jsx(PlaceModal, {\n    size: \"lg\",\n    lgShow: lgShow,\n    setLgShow: setLgShow,\n    score: 3,\n    title: selectedPlace ? selectedPlace.FACLT_NM : \"\",\n    addr: selectedPlace ? selectedPlace.REFINE_ROADNM_ADDR : \"\",\n    contact: selectedPlace ? selectedPlace.CONTCT_NO : \"\",\n    des: des,\n    img: img,\n    lat: selectedPlace ? selectedPlace.REFINE_WGS84_LAT : null,\n    lng: selectedPlace ? selectedPlace.REFINE_WGS84_LOGT : null,\n    bdList: bdList,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 13\n    }\n  }), __jsx(Modal, {\n    title: \"\\uC54C\\uB9BC\",\n    class: \"searchModal\",\n    size: \"sm\",\n    lgShow: show,\n    setLgShow: setShow,\n    children: \"\\uD574\\uB2F9\\uD558\\uB294 \\uC2DC\\uC124\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 13\n    }\n  }));\n}\ngetLayout(Index, {\n  title: '주변에서 운동해요! WAKAUT!',\n  description: '신개념 운동 플랫폼 워크아웃!'\n});","map":{"version":3,"sources":["C:/Users/fullstack/Desktop/TeamWorks/WAKAUT/next/pages/index.js"],"names":["Button","Container","Form","FormSelect","List","useEffect","useState","AiTwotoneHeart","PlaceModal","img","mapicon","getLayout","Modal","Datas","handleFacilityChange","handleSearchButtonClick","handleSearchTextChange","handleShowAll","handleSigunChange","dynamic","Map","then","module","ssr","MapMarker","getServerSideProps","ctx","word","query","items","props","Index","des","lgShow","setLgShow","show","setShow","selectedSigun","setSelectedSigun","selectedFacility","setSelectedFacility","searchText","setSearchText","searchResults","setSearchResults","selectedPlace","setSelectedPlace","searchCount","setSearchCount","length","isButtonActive","setIsButtonActive","bdList","setBDLists","getFacilityOptions","sigun","facilities","filter","item","SIGUN_NM","facilityNames","Set","map","FACLT_DIV_NM","name","state","setState","center","lat","lng","errMsg","isLoading","navigator","geolocation","getCurrentPosition","position","prev","coords","latitude","longitude","err","message","lists","fcname","boards","r","FACLT_NM","REFINE_ROADNM_ADDR","parseFloat","REFINE_WGS84_LAT","REFINE_WGS84_LOGT","e","width","height","src","size","options","offset","x","y","CONTCT_NO","title","description"],"mappings":"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","sourcesContent":["import {Button, Container, Form, FormSelect} from \"react-bootstrap\";\r\nimport List from \"../components/list\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { AiTwotoneHeart } from \"react-icons/ai\";\r\nimport PlaceModal from \"./place_modal\";\r\nimport img from '../assets/workaut.png';\r\nimport mapicon from '../assets/map-icon.png';\r\nimport getLayout from \"../components/layouts/getLayout\";\r\nimport Modal from \"../components/modal\";\r\nimport {Datas} from \"../components/feutils\";\r\nimport {\r\n    handleFacilityChange,\r\n    handleSearchButtonClick,\r\n    handleSearchTextChange,\r\n    handleShowAll,\r\n    handleSigunChange\r\n} from \"../models/Utils\";\r\n\r\nimport dynamic from 'next/dynamic';\r\n\r\n\r\nconst Map = dynamic(() => import(\"react-kakao-maps-sdk\").then((module) => module.Map), {\r\n    ssr: false\r\n});\r\nconst MapMarker = dynamic(() => import(\"react-kakao-maps-sdk\").then((module) => module.MapMarker), {\r\n    ssr: false\r\n});\r\n\r\nexport async function getServerSideProps(ctx) {\r\n    const word = ctx.query.word || '';\r\n    let items = await Datas('/main', `srch=${word}`);\r\n    return {props: {items: items, word: word}}\r\n}\r\n\r\nexport default function Index({items, word}) {\r\n    let des = '#에어로빅 #줌바 #조깅';\r\n\r\n    const [lgShow, setLgShow] = useState(false);\r\n    const [show, setShow] = useState(false);\r\n    const [selectedSigun, setSelectedSigun] = useState(\"\");\r\n    const [selectedFacility, setSelectedFacility] = useState(\"\");\r\n    const [searchText, setSearchText] = useState(\"\");\r\n    const [searchResults, setSearchResults] = useState(items);  // 검색결과 저장 state\r\n    const [selectedPlace, setSelectedPlace] = useState(null);   // 마커 클릭시 모달 state\r\n    const [searchCount, setSearchCount] = useState(items.length);  // 총 몇개의 시설이 조회된건지 저장하는 state\r\n    const [isButtonActive, setIsButtonActive] = useState(false);\r\n    const [bdList, setBDLists] = useState({});\r\n\r\n\r\n\r\n    // 시군명 선택 시 시설구분명 셀렉트 태그에 표시할 options 배열 반환\r\n    function getFacilityOptions(sigun) {\r\n        const facilities = items.filter((item) => item.SIGUN_NM === sigun);\r\n        const facilityNames = [...new Set(facilities.map((item) => item.FACLT_DIV_NM))];\r\n        return facilityNames.map((name) => <option key={name}>{name}</option>);\r\n    }\r\n\r\n\r\n    const [state, setState] = useState({\r\n        center: {\r\n            lat: 37.28892227326957,\r\n            lng: 127.05363481102465,\r\n        },\r\n        errMsg: null,\r\n        isLoading: true,\r\n    })\r\n\r\n    // useEffect는 최초 렌더링 이후에 실행됩니다. useEffect의 첫 번째 인자로 전달한\r\n    // 함수는 컴포넌트가 마운트(처음으로 렌더링)된 이후에 한번 실행되며, 두 번째 인자로\r\n    // 전달한 배열에 지정한 값이 변경되었을 때에도 실행됩니다.\r\n    useEffect(() => {\r\n        if (navigator.geolocation) {\r\n            // GeoLocation을 이용해서 접속 위치를 얻어옵니다\r\n            navigator.geolocation.getCurrentPosition(\r\n                (position) => {\r\n                    setState((prev) => ({\r\n                        ...prev,\r\n                        center: {\r\n                            lat: position.coords.latitude, // 위도\r\n                            lng: position.coords.longitude, // 경도\r\n                        },\r\n                        isLoading: false,\r\n                    }))\r\n                },\r\n                (err) => {\r\n                    setState((prev) => ({\r\n                        ...prev,\r\n                        errMsg: err.message,\r\n                        isLoading: false,\r\n                    }))\r\n                }\r\n            )\r\n        } else {\r\n            // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다\r\n            setState((prev) => ({\r\n                ...prev,\r\n                errMsg: \"geolocation을 사용할수 없어요..\",\r\n                isLoading: false,\r\n            }))\r\n        }\r\n    }, [])\r\n\r\n    // 게시글 목록 가지고 오기\r\n    async function lists(fcname){\r\n        let boards = await Datas('/board/boardlist',`pg=5&fcname=${fcname}`).then(r=>r);\r\n        setBDLists(await boards);\r\n    }\r\n\r\n\r\n    return(\r\n        <Container className=\"d-flex mt-4 mb-4 index\">\r\n            <div className=\"left col-6 \">\r\n                <p>총 {searchCount}건</p>\r\n                {searchResults.map((item) => (\r\n                    <List\r\n                        key={item.FACLT_NM}\r\n                        title={item.FACLT_NM}\r\n                        malcnt={<AiTwotoneHeart />}\r\n                        note={item.REFINE_ROADNM_ADDR}\r\n                        col=\"bg-secondary\"\r\n                        textClick={() => {\r\n                            setSelectedPlace(item);\r\n                            setLgShow(true);\r\n                            const lat = parseFloat(item.REFINE_WGS84_LAT);\r\n                            const lng = parseFloat(item.REFINE_WGS84_LOGT);\r\n                            setState((prev) => ({\r\n                                ...prev,\r\n                                center: { lat, lng },\r\n                            }));\r\n                            lists(item.FACLT_NM);\r\n                        }}\r\n                    />\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"right col-6 ms-4\">\r\n                {word ? <Button className=\"showAll-btn mb-2\" variant=\"outline-success\" onClick={handleShowAll}>전체 시설보기</Button> : false}\r\n                <Form className=\"d-flex mb-2\">\r\n                    <FormSelect value={selectedSigun}\r\n                                onChange={e => handleSigunChange(\r\n                                    e,\r\n                                    setSelectedSigun,\r\n                                    setSelectedFacility,\r\n                                    setSearchText,\r\n                                    items,\r\n                                    setState,\r\n                                    setSearchResults,\r\n                                    setSearchCount)\r\n                                }>\r\n                        <option value=\"\">시군</option>\r\n                        {/* API에서 불러오는 데이터중 시군 데이터로 새로운 배열을 생성하되 중복을 제거함 */}\r\n                        {\r\n                            [...new Set(items.map((item) => item.SIGUN_NM))].map((sigun) => (\r\n                                <option key={sigun} value={sigun}>{sigun}</option>\r\n                            ))\r\n                        }\r\n                    </FormSelect>\r\n                    {selectedSigun\r\n                        ?\r\n                        <FormSelect value={selectedFacility} onChange={e => handleFacilityChange(e, setSelectedFacility)}>\r\n                            <option value=\"\">시설구분명</option>\r\n                            {getFacilityOptions(selectedSigun)}\r\n                        </FormSelect>\r\n                        :\r\n                        <FormSelect >\r\n                            <option>시설구분명</option>\r\n                        </FormSelect>\r\n                    }\r\n                    <Form.Control\r\n                        type=\"text\"\r\n                        placeholder=\"어디서 운동할까요?\"\r\n                        value={searchText}\r\n                        onChange={e => handleSearchTextChange(e, setSearchText, setSearchResults, setSearchCount, setIsButtonActive)}\r\n                    />\r\n                    <Button className=\"facility-btn\" variant=\"outline-success\"\r\n                            active={isButtonActive}\r\n                            onClick={() => handleSearchButtonClick(\r\n                                items,\r\n                                selectedSigun,\r\n                                selectedFacility,\r\n                                searchText,\r\n                                setShow,\r\n                                setSearchResults,\r\n                                setSearchCount,\r\n                            )}>Search</Button>\r\n                </Form>\r\n\r\n            <Map center={state.center} style={{ width: \"100%\", height: \"800px\" }}  level={3}>\r\n                {(!state.isLoading ? searchResults : []).map((item) => (\r\n                    <MapMarker\r\n                        key={item.FACLT_NM}\r\n                        position={{ lat: item.REFINE_WGS84_LAT, lng: item.REFINE_WGS84_LOGT }}\r\n                        onClick={() => {\r\n                            setSelectedPlace(item);\r\n                            setLgShow(true);\r\n                        }}\r\n                        image={{\r\n                            src: `${mapicon}`,\r\n                            size: {width: 30, height: 30,},\r\n                            options: {\r\n                             offset: {x: 27, y: 69,},\r\n                        },\r\n                        }}\r\n                    />\r\n                ))}\r\n            </Map>\r\n            </div>\r\n            <PlaceModal\r\n                size=\"lg\"\r\n                lgShow={lgShow}\r\n                setLgShow={setLgShow}\r\n                score={3}\r\n                title={selectedPlace ? selectedPlace.FACLT_NM : \"\"}\r\n                addr={selectedPlace ? selectedPlace.REFINE_ROADNM_ADDR : \"\"}\r\n                contact={selectedPlace ? selectedPlace.CONTCT_NO : \"\"}\r\n                des={des}\r\n                img={img}\r\n                lat={selectedPlace ? selectedPlace.REFINE_WGS84_LAT : null}\r\n                lng={selectedPlace ? selectedPlace.REFINE_WGS84_LOGT : null}\r\n                bdList={bdList}\r\n            />\r\n            <Modal title=\"알림\" class=\"searchModal\" size=\"sm\" lgShow={show} setLgShow={setShow}  children=\"해당하는 시설이 없습니다.\"/>\r\n        </Container>\r\n    )\r\n}\r\n\r\ngetLayout(Index,{title:'주변에서 운동해요! WAKAUT!',description:'신개념 운동 플랫폼 워크아웃!'})\r\n"]},"metadata":{},"sourceType":"module"}